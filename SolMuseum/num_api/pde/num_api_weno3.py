import numpy as np
from numba import njit

@njit(cache=True)
def weno_odeq(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (0.5*S*((2/3)*((1/2)*p0 + (1/2)*pm1)/(((p0 - pm1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*p0 - 1/2*pp1)/(((-p0 + pp1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2))) + 0.5*S*((2/3)*((1/2)*p0 + (1/2)*pm1)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*pm1 - 1/2*pm2)/(((pm1 - pm2)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2))) - 0.5*S*((2/3)*((1/2)*p0 + (1/2)*pp1)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*p0 - 1/2*pm1)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))) - 0.5*S*((2/3)*((1/2)*p0 + (1/2)*pp1)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*pp1 - 1/2*pp2)/(((-pp1 + pp2)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))) - 0.5*va*((2/3)*((1/2)*q0 + (1/2)*qm1)/(((q0 - qm1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*q0 - 1/2*qp1)/(((-q0 + qp1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2))) + 0.5*va*((2/3)*((1/2)*q0 + (1/2)*qm1)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*qm1 - 1/2*qm2)/(((qm1 - qm2)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2))) - 0.5*va*((2/3)*((1/2)*q0 + (1/2)*qp1)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*q0 - 1/2*qm1)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2))) + 0.5*va*((2/3)*((1/2)*q0 + (1/2)*qp1)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*qp1 - 1/2*qp2)/(((-qp1 + qp2)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2))))/dx - 1/2*lam*va**2*q0*np.abs(q0)/(D*S*p0)

@njit(cache=True)
def weno_odep(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (-0.5*va*((2/3)*((1/2)*p0 + (1/2)*pm1)/(((p0 - pm1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*p0 - 1/2*pp1)/(((-p0 + pp1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2))) + 0.5*va*((2/3)*((1/2)*p0 + (1/2)*pm1)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*pm1 - 1/2*pm2)/(((pm1 - pm2)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2))) - 0.5*va*((2/3)*((1/2)*p0 + (1/2)*pp1)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*p0 - 1/2*pm1)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))) + 0.5*va*((2/3)*((1/2)*p0 + (1/2)*pp1)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*pp1 - 1/2*pp2)/(((-pp1 + pp2)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))) + 0.5*va**2*((2/3)*((1/2)*q0 + (1/2)*qm1)/(((q0 - qm1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*q0 - 1/2*qp1)/(((-q0 + qp1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/S + 0.5*va**2*((2/3)*((1/2)*q0 + (1/2)*qm1)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*qm1 - 1/2*qm2)/(((qm1 - qm2)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)))/S - 0.5*va**2*((2/3)*((1/2)*q0 + (1/2)*qp1)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*q0 - 1/2*qm1)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/S - 0.5*va**2*((2/3)*((1/2)*q0 + (1/2)*qp1)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*qp1 - 1/2*qp2)/(((-qp1 + qp2)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/S)/dx

@njit(cache=True)
def dweno_odeqdqp2(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return 0.5*va*(-2/9*((1/2)*q0 + (1/2)*qp1)*(4*qp1 - 4*qp2)/(((-q0 + qp1)**2 + 1/1000000)**2*((-qp1 + qp2)**2 + 1/1000000)**3*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*qp1 - 1/2*qp2)*(4*qp1 - 4*qp2)/(((-qp1 + qp2)**2 + 1/1000000)**3*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*qp1 - 1/2*qp2)*(4*qp1 - 4*qp2)/(((-qp1 + qp2)**2 + 1/1000000)**5*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - (1/6)/(((-qp1 + qp2)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/dx

@njit(cache=True)
def dweno_odeqdp0(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (0.5*S*((2/3)*(-4*p0 + 4*pm1)*((1/2)*p0 + (1/2)*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) - 4/9*(-4*p0 + 4*pm1)*((1/2)*p0 + (1/2)*pm1)/(((p0 - pm1)**2 + 1/1000000)**5*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) - 2/9*(-4*p0 + 4*pm1)*((3/2)*pm1 - 1/2*pm2)/(((p0 - pm1)**2 + 1/1000000)**3*((pm1 - pm2)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) + (1/3)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2))) - 0.5*S*((2/3)*(-4*p0 + 4*pp1)*((1/2)*p0 + (1/2)*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 4/9*(-4*p0 + 4*pp1)*((1/2)*p0 + (1/2)*pp1)/(((-p0 + pp1)**2 + 1/1000000)**5*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - 2/9*(-4*p0 + 4*pp1)*((3/2)*pp1 - 1/2*pp2)/(((-p0 + pp1)**2 + 1/1000000)**3*((-pp1 + pp2)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))) + 0.5*S*((2/3)*(-4*p0 + 4*pm1)*((1/2)*p0 + (1/2)*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)*(-4*p0 + 4*pp1)*((3/2)*p0 - 1/2*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*p0 + (1/2)*pm1)*(-2/3*(-4*p0 + 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 1/3*(-4*p0 + 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3)/(((p0 - pm1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*p0 - 1/2*pp1)*(-2/3*(-4*p0 + 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 1/3*(-4*p0 + 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3)/(((-p0 + pp1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)/(((p0 - pm1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/2)/(((-p0 + pp1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2))) - 0.5*S*((1/3)*(-4*p0 + 4*pm1)*((3/2)*p0 - 1/2*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (2/3)*(-4*p0 + 4*pp1)*((1/2)*p0 + (1/2)*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*p0 + (1/2)*pp1)*(-1/3*(-4*p0 + 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 2/3*(-4*p0 + 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*p0 - 1/2*pm1)*(-1/3*(-4*p0 + 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 2/3*(-4*p0 + 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/2)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))))/dx + (1/2)*lam*va**2*q0*np.abs(q0)/(D*S*p0**2)

@njit(cache=True)
def dweno_odeqdpm2(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return 0.5*S*(-2/9*((1/2)*p0 + (1/2)*pm1)*(4*pm1 - 4*pm2)/(((p0 - pm1)**2 + 1/1000000)**2*((pm1 - pm2)**2 + 1/1000000)**3*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*pm1 - 1/2*pm2)*(4*pm1 - 4*pm2)/(((pm1 - pm2)**2 + 1/1000000)**3*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) - 1/9*((3/2)*pm1 - 1/2*pm2)*(4*pm1 - 4*pm2)/(((pm1 - pm2)**2 + 1/1000000)**5*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) - (1/6)/(((pm1 - pm2)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)))/dx

@njit(cache=True)
def dweno_odeqdqp1(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (-0.5*va*((2/3)*((1/2)*q0 + (1/2)*qp1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 4/9*((1/2)*q0 + (1/2)*qp1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**5*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - 2/9*((3/2)*q0 - 1/2*qm1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2))) - 0.5*va*(-2/9*((1/2)*q0 + (1/2)*qm1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((q0 - qm1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*q0 - 1/2*qp1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*q0 - 1/2*qp1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**5*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - (1/6)/(((-q0 + qp1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2))) + 0.5*va*((2/3)*((1/2)*q0 + (1/2)*qp1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*q0 + (1/2)*qp1)*(-2/3*(4*q0 - 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3 - 1/3*(-4*qp1 + 4*qp2)/((-qp1 + qp2)**2 + 1/1000000)**3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*(-4*qp1 + 4*qp2)*((3/2)*qp1 - 1/2*qp2)/(((-qp1 + qp2)**2 + 1/1000000)**3*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*qp1 - 1/2*qp2)*(-2/3*(4*q0 - 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3 - 1/3*(-4*qp1 + 4*qp2)/((-qp1 + qp2)**2 + 1/1000000)**3)/(((-qp1 + qp2)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/2)/(((-qp1 + qp2)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2))))/dx

@njit(cache=True)
def dweno_odeqdqm1(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (-0.5*va*((2/3)*((1/2)*q0 + (1/2)*qm1)*(4*q0 - 4*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 4/9*((1/2)*q0 + (1/2)*qm1)*(4*q0 - 4*qm1)/(((q0 - qm1)**2 + 1/1000000)**5*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - 2/9*((3/2)*q0 - 1/2*qp1)*(4*q0 - 4*qm1)/(((-q0 + qp1)**2 + 1/1000000)**2*((q0 - qm1)**2 + 1/1000000)**3*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)/(((q0 - qm1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2))) - 0.5*va*(-2/9*((1/2)*q0 + (1/2)*qp1)*(4*q0 - 4*qm1)/(((-q0 + qp1)**2 + 1/1000000)**2*((q0 - qm1)**2 + 1/1000000)**3*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*q0 - 1/2*qm1)*(4*q0 - 4*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*q0 - 1/2*qm1)*(4*q0 - 4*qm1)/(((q0 - qm1)**2 + 1/1000000)**5*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - (1/6)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2))) + 0.5*va*((2/3)*((1/2)*q0 + (1/2)*qm1)*(4*q0 - 4*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*q0 + (1/2)*qm1)*(-2/3*(4*q0 - 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 1/3*(-4*qm1 + 4*qm2)/((qm1 - qm2)**2 + 1/1000000)**3)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) + (1/3)*(-4*qm1 + 4*qm2)*((3/2)*qm1 - 1/2*qm2)/(((qm1 - qm2)**2 + 1/1000000)**3*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*qm1 - 1/2*qm2)*(-2/3*(4*q0 - 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 1/3*(-4*qm1 + 4*qm2)/((qm1 - qm2)**2 + 1/1000000)**3)/(((qm1 - qm2)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) + (1/2)/(((qm1 - qm2)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) + (1/3)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2))))/dx

@njit(cache=True)
def dweno_odeqdpp2(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return -0.5*S*(-2/9*((1/2)*p0 + (1/2)*pp1)*(4*pp1 - 4*pp2)/(((-p0 + pp1)**2 + 1/1000000)**2*((-pp1 + pp2)**2 + 1/1000000)**3*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*pp1 - 1/2*pp2)*(4*pp1 - 4*pp2)/(((-pp1 + pp2)**2 + 1/1000000)**3*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*pp1 - 1/2*pp2)*(4*pp1 - 4*pp2)/(((-pp1 + pp2)**2 + 1/1000000)**5*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - (1/6)/(((-pp1 + pp2)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)))/dx

@njit(cache=True)
def dweno_odeqdq0(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (0.5*va*((2/3)*(-4*q0 + 4*qm1)*((1/2)*q0 + (1/2)*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) - 4/9*(-4*q0 + 4*qm1)*((1/2)*q0 + (1/2)*qm1)/(((q0 - qm1)**2 + 1/1000000)**5*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) - 2/9*(-4*q0 + 4*qm1)*((3/2)*qm1 - 1/2*qm2)/(((q0 - qm1)**2 + 1/1000000)**3*((qm1 - qm2)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) + (1/3)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2))) + 0.5*va*((2/3)*(-4*q0 + 4*qp1)*((1/2)*q0 + (1/2)*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 4/9*(-4*q0 + 4*qp1)*((1/2)*q0 + (1/2)*qp1)/(((-q0 + qp1)**2 + 1/1000000)**5*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - 2/9*(-4*q0 + 4*qp1)*((3/2)*qp1 - 1/2*qp2)/(((-q0 + qp1)**2 + 1/1000000)**3*((-qp1 + qp2)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2))) - 0.5*va*((2/3)*(-4*q0 + 4*qm1)*((1/2)*q0 + (1/2)*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)*(-4*q0 + 4*qp1)*((3/2)*q0 - 1/2*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*q0 + (1/2)*qm1)*(-2/3*(-4*q0 + 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 1/3*(-4*q0 + 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3)/(((q0 - qm1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*q0 - 1/2*qp1)*(-2/3*(-4*q0 + 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 1/3*(-4*q0 + 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3)/(((-q0 + qp1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)/(((q0 - qm1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/2)/(((-q0 + qp1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2))) - 0.5*va*((1/3)*(-4*q0 + 4*qm1)*((3/2)*q0 - 1/2*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (2/3)*(-4*q0 + 4*qp1)*((1/2)*q0 + (1/2)*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*q0 + (1/2)*qp1)*(-1/3*(-4*q0 + 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 2/3*(-4*q0 + 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*q0 - 1/2*qm1)*(-1/3*(-4*q0 + 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 2/3*(-4*q0 + 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/2)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2))))/dx - 1/2*lam*va**2*q0*np.sign(q0)/(D*S*p0) - 1/2*lam*va**2*np.abs(q0)/(D*S*p0)

@njit(cache=True)
def dweno_odeqdpm1(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (0.5*S*((2/3)*((1/2)*p0 + (1/2)*pm1)*(4*p0 - 4*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 4/9*((1/2)*p0 + (1/2)*pm1)*(4*p0 - 4*pm1)/(((p0 - pm1)**2 + 1/1000000)**5*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - 2/9*((3/2)*p0 - 1/2*pp1)*(4*p0 - 4*pm1)/(((-p0 + pp1)**2 + 1/1000000)**2*((p0 - pm1)**2 + 1/1000000)**3*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)/(((p0 - pm1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2))) - 0.5*S*(-2/9*((1/2)*p0 + (1/2)*pp1)*(4*p0 - 4*pm1)/(((-p0 + pp1)**2 + 1/1000000)**2*((p0 - pm1)**2 + 1/1000000)**3*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*p0 - 1/2*pm1)*(4*p0 - 4*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*p0 - 1/2*pm1)*(4*p0 - 4*pm1)/(((p0 - pm1)**2 + 1/1000000)**5*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - (1/6)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))) + 0.5*S*((2/3)*((1/2)*p0 + (1/2)*pm1)*(4*p0 - 4*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*p0 + (1/2)*pm1)*(-2/3*(4*p0 - 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 1/3*(-4*pm1 + 4*pm2)/((pm1 - pm2)**2 + 1/1000000)**3)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) + (1/3)*(-4*pm1 + 4*pm2)*((3/2)*pm1 - 1/2*pm2)/(((pm1 - pm2)**2 + 1/1000000)**3*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*pm1 - 1/2*pm2)*(-2/3*(4*p0 - 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 1/3*(-4*pm1 + 4*pm2)/((pm1 - pm2)**2 + 1/1000000)**3)/(((pm1 - pm2)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) + (1/2)/(((pm1 - pm2)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) + (1/3)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2))))/dx

@njit(cache=True)
def dweno_odeqdqm2(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return 0.5*va*(-2/9*((1/2)*q0 + (1/2)*qm1)*(4*qm1 - 4*qm2)/(((q0 - qm1)**2 + 1/1000000)**2*((qm1 - qm2)**2 + 1/1000000)**3*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*qm1 - 1/2*qm2)*(4*qm1 - 4*qm2)/(((qm1 - qm2)**2 + 1/1000000)**3*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) - 1/9*((3/2)*qm1 - 1/2*qm2)*(4*qm1 - 4*qm2)/(((qm1 - qm2)**2 + 1/1000000)**5*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) - (1/6)/(((qm1 - qm2)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)))/dx

@njit(cache=True)
def dweno_odeqdpp1(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (-0.5*S*((2/3)*((1/2)*p0 + (1/2)*pp1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 4/9*((1/2)*p0 + (1/2)*pp1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**5*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - 2/9*((3/2)*p0 - 1/2*pm1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))) + 0.5*S*(-2/9*((1/2)*p0 + (1/2)*pm1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((p0 - pm1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*p0 - 1/2*pp1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*p0 - 1/2*pp1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**5*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - (1/6)/(((-p0 + pp1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2))) - 0.5*S*((2/3)*((1/2)*p0 + (1/2)*pp1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*p0 + (1/2)*pp1)*(-2/3*(4*p0 - 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3 - 1/3*(-4*pp1 + 4*pp2)/((-pp1 + pp2)**2 + 1/1000000)**3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*(-4*pp1 + 4*pp2)*((3/2)*pp1 - 1/2*pp2)/(((-pp1 + pp2)**2 + 1/1000000)**3*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*pp1 - 1/2*pp2)*(-2/3*(4*p0 - 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3 - 1/3*(-4*pp1 + 4*pp2)/((-pp1 + pp2)**2 + 1/1000000)**3)/(((-pp1 + pp2)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/2)/(((-pp1 + pp2)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))))/dx

@njit(cache=True)
def dweno_odepdqp2(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return -0.5*va**2*(-2/9*((1/2)*q0 + (1/2)*qp1)*(4*qp1 - 4*qp2)/(((-q0 + qp1)**2 + 1/1000000)**2*((-qp1 + qp2)**2 + 1/1000000)**3*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*qp1 - 1/2*qp2)*(4*qp1 - 4*qp2)/(((-qp1 + qp2)**2 + 1/1000000)**3*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*qp1 - 1/2*qp2)*(4*qp1 - 4*qp2)/(((-qp1 + qp2)**2 + 1/1000000)**5*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - (1/6)/(((-qp1 + qp2)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/(S*dx)

@njit(cache=True)
def dweno_odepdp0(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (0.5*va*((2/3)*(-4*p0 + 4*pm1)*((1/2)*p0 + (1/2)*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) - 4/9*(-4*p0 + 4*pm1)*((1/2)*p0 + (1/2)*pm1)/(((p0 - pm1)**2 + 1/1000000)**5*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) - 2/9*(-4*p0 + 4*pm1)*((3/2)*pm1 - 1/2*pm2)/(((p0 - pm1)**2 + 1/1000000)**3*((pm1 - pm2)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) + (1/3)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2))) + 0.5*va*((2/3)*(-4*p0 + 4*pp1)*((1/2)*p0 + (1/2)*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 4/9*(-4*p0 + 4*pp1)*((1/2)*p0 + (1/2)*pp1)/(((-p0 + pp1)**2 + 1/1000000)**5*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - 2/9*(-4*p0 + 4*pp1)*((3/2)*pp1 - 1/2*pp2)/(((-p0 + pp1)**2 + 1/1000000)**3*((-pp1 + pp2)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))) - 0.5*va*((2/3)*(-4*p0 + 4*pm1)*((1/2)*p0 + (1/2)*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)*(-4*p0 + 4*pp1)*((3/2)*p0 - 1/2*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*p0 + (1/2)*pm1)*(-2/3*(-4*p0 + 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 1/3*(-4*p0 + 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3)/(((p0 - pm1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*p0 - 1/2*pp1)*(-2/3*(-4*p0 + 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 1/3*(-4*p0 + 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3)/(((-p0 + pp1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)/(((p0 - pm1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/2)/(((-p0 + pp1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2))) - 0.5*va*((1/3)*(-4*p0 + 4*pm1)*((3/2)*p0 - 1/2*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (2/3)*(-4*p0 + 4*pp1)*((1/2)*p0 + (1/2)*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*p0 + (1/2)*pp1)*(-1/3*(-4*p0 + 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 2/3*(-4*p0 + 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*p0 - 1/2*pm1)*(-1/3*(-4*p0 + 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 2/3*(-4*p0 + 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/2)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))))/dx

@njit(cache=True)
def dweno_odepdpm2(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return 0.5*va*(-2/9*((1/2)*p0 + (1/2)*pm1)*(4*pm1 - 4*pm2)/(((p0 - pm1)**2 + 1/1000000)**2*((pm1 - pm2)**2 + 1/1000000)**3*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*pm1 - 1/2*pm2)*(4*pm1 - 4*pm2)/(((pm1 - pm2)**2 + 1/1000000)**3*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) - 1/9*((3/2)*pm1 - 1/2*pm2)*(4*pm1 - 4*pm2)/(((pm1 - pm2)**2 + 1/1000000)**5*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) - (1/6)/(((pm1 - pm2)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)))/dx

@njit(cache=True)
def dweno_odepdqm1(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (0.5*va**2*((2/3)*((1/2)*q0 + (1/2)*qm1)*(4*q0 - 4*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 4/9*((1/2)*q0 + (1/2)*qm1)*(4*q0 - 4*qm1)/(((q0 - qm1)**2 + 1/1000000)**5*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - 2/9*((3/2)*q0 - 1/2*qp1)*(4*q0 - 4*qm1)/(((-q0 + qp1)**2 + 1/1000000)**2*((q0 - qm1)**2 + 1/1000000)**3*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)/(((q0 - qm1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/S - 0.5*va**2*(-2/9*((1/2)*q0 + (1/2)*qp1)*(4*q0 - 4*qm1)/(((-q0 + qp1)**2 + 1/1000000)**2*((q0 - qm1)**2 + 1/1000000)**3*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*q0 - 1/2*qm1)*(4*q0 - 4*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*q0 - 1/2*qm1)*(4*q0 - 4*qm1)/(((q0 - qm1)**2 + 1/1000000)**5*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - (1/6)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/S + 0.5*va**2*((2/3)*((1/2)*q0 + (1/2)*qm1)*(4*q0 - 4*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*q0 + (1/2)*qm1)*(-2/3*(4*q0 - 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 1/3*(-4*qm1 + 4*qm2)/((qm1 - qm2)**2 + 1/1000000)**3)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) + (1/3)*(-4*qm1 + 4*qm2)*((3/2)*qm1 - 1/2*qm2)/(((qm1 - qm2)**2 + 1/1000000)**3*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*qm1 - 1/2*qm2)*(-2/3*(4*q0 - 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 1/3*(-4*qm1 + 4*qm2)/((qm1 - qm2)**2 + 1/1000000)**3)/(((qm1 - qm2)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) + (1/2)/(((qm1 - qm2)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) + (1/3)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)))/S)/dx

@njit(cache=True)
def dweno_odepdpp2(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return 0.5*va*(-2/9*((1/2)*p0 + (1/2)*pp1)*(4*pp1 - 4*pp2)/(((-p0 + pp1)**2 + 1/1000000)**2*((-pp1 + pp2)**2 + 1/1000000)**3*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*pp1 - 1/2*pp2)*(4*pp1 - 4*pp2)/(((-pp1 + pp2)**2 + 1/1000000)**3*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*pp1 - 1/2*pp2)*(4*pp1 - 4*pp2)/(((-pp1 + pp2)**2 + 1/1000000)**5*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - (1/6)/(((-pp1 + pp2)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)))/dx

@njit(cache=True)
def dweno_odepdq0(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (0.5*va**2*((2/3)*(-4*q0 + 4*qm1)*((1/2)*q0 + (1/2)*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) - 4/9*(-4*q0 + 4*qm1)*((1/2)*q0 + (1/2)*qm1)/(((q0 - qm1)**2 + 1/1000000)**5*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) - 2/9*(-4*q0 + 4*qm1)*((3/2)*qm1 - 1/2*qm2)/(((q0 - qm1)**2 + 1/1000000)**3*((qm1 - qm2)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) + (1/3)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)))/S - 0.5*va**2*((2/3)*(-4*q0 + 4*qp1)*((1/2)*q0 + (1/2)*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 4/9*(-4*q0 + 4*qp1)*((1/2)*q0 + (1/2)*qp1)/(((-q0 + qp1)**2 + 1/1000000)**5*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - 2/9*(-4*q0 + 4*qp1)*((3/2)*qp1 - 1/2*qp2)/(((-q0 + qp1)**2 + 1/1000000)**3*((-qp1 + qp2)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/S + 0.5*va**2*((2/3)*(-4*q0 + 4*qm1)*((1/2)*q0 + (1/2)*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)*(-4*q0 + 4*qp1)*((3/2)*q0 - 1/2*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*q0 + (1/2)*qm1)*(-2/3*(-4*q0 + 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 1/3*(-4*q0 + 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3)/(((q0 - qm1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*q0 - 1/2*qp1)*(-2/3*(-4*q0 + 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 1/3*(-4*q0 + 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3)/(((-q0 + qp1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)/(((q0 - qm1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/2)/(((-q0 + qp1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/S - 0.5*va**2*((1/3)*(-4*q0 + 4*qm1)*((3/2)*q0 - 1/2*qm1)/(((q0 - qm1)**2 + 1/1000000)**3*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (2/3)*(-4*q0 + 4*qp1)*((1/2)*q0 + (1/2)*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*q0 + (1/2)*qp1)*(-1/3*(-4*q0 + 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 2/3*(-4*q0 + 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*q0 - 1/2*qm1)*(-1/3*(-4*q0 + 4*qm1)/((q0 - qm1)**2 + 1/1000000)**3 - 2/3*(-4*q0 + 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/2)/(((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/S)/dx

@njit(cache=True)
def dweno_odepdqp1(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (-0.5*va**2*((2/3)*((1/2)*q0 + (1/2)*qp1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 4/9*((1/2)*q0 + (1/2)*qp1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**5*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - 2/9*((3/2)*q0 - 1/2*qm1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((q0 - qm1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((q0 - qm1)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/S + 0.5*va**2*(-2/9*((1/2)*q0 + (1/2)*qm1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((q0 - qm1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*q0 - 1/2*qp1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*q0 - 1/2*qp1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**5*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) - (1/6)/(((-q0 + qp1)**2 + 1/1000000)**2*((2/3)/((q0 - qm1)**2 + 1/1000000)**2 + (1/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/S - 0.5*va**2*((2/3)*((1/2)*q0 + (1/2)*qp1)*(4*q0 - 4*qp1)/(((-q0 + qp1)**2 + 1/1000000)**3*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*q0 + (1/2)*qp1)*(-2/3*(4*q0 - 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3 - 1/3*(-4*qp1 + 4*qp2)/((-qp1 + qp2)**2 + 1/1000000)**3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/3)*(-4*qp1 + 4*qp2)*((3/2)*qp1 - 1/2*qp2)/(((-qp1 + qp2)**2 + 1/1000000)**3*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*qp1 - 1/2*qp2)*(-2/3*(4*q0 - 4*qp1)/((-q0 + qp1)**2 + 1/1000000)**3 - 1/3*(-4*qp1 + 4*qp2)/((-qp1 + qp2)**2 + 1/1000000)**3)/(((-qp1 + qp2)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)**2) + (1/2)/(((-qp1 + qp2)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)) + (1/3)/(((-q0 + qp1)**2 + 1/1000000)**2*((1/3)/((-qp1 + qp2)**2 + 1/1000000)**2 + (2/3)/((-q0 + qp1)**2 + 1/1000000)**2)))/S)/dx

@njit(cache=True)
def dweno_odepdpm1(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (-0.5*va*((2/3)*((1/2)*p0 + (1/2)*pm1)*(4*p0 - 4*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 4/9*((1/2)*p0 + (1/2)*pm1)*(4*p0 - 4*pm1)/(((p0 - pm1)**2 + 1/1000000)**5*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - 2/9*((3/2)*p0 - 1/2*pp1)*(4*p0 - 4*pm1)/(((-p0 + pp1)**2 + 1/1000000)**2*((p0 - pm1)**2 + 1/1000000)**3*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)/(((p0 - pm1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2))) - 0.5*va*(-2/9*((1/2)*p0 + (1/2)*pp1)*(4*p0 - 4*pm1)/(((-p0 + pp1)**2 + 1/1000000)**2*((p0 - pm1)**2 + 1/1000000)**3*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*p0 - 1/2*pm1)*(4*p0 - 4*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*p0 - 1/2*pm1)*(4*p0 - 4*pm1)/(((p0 - pm1)**2 + 1/1000000)**5*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - (1/6)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))) + 0.5*va*((2/3)*((1/2)*p0 + (1/2)*pm1)*(4*p0 - 4*pm1)/(((p0 - pm1)**2 + 1/1000000)**3*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*p0 + (1/2)*pm1)*(-2/3*(4*p0 - 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 1/3*(-4*pm1 + 4*pm2)/((pm1 - pm2)**2 + 1/1000000)**3)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) + (1/3)*(-4*pm1 + 4*pm2)*((3/2)*pm1 - 1/2*pm2)/(((pm1 - pm2)**2 + 1/1000000)**3*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*pm1 - 1/2*pm2)*(-2/3*(4*p0 - 4*pm1)/((p0 - pm1)**2 + 1/1000000)**3 - 1/3*(-4*pm1 + 4*pm2)/((pm1 - pm2)**2 + 1/1000000)**3)/(((pm1 - pm2)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)**2) + (1/2)/(((pm1 - pm2)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2)) + (1/3)/(((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((pm1 - pm2)**2 + 1/1000000)**2 + (2/3)/((p0 - pm1)**2 + 1/1000000)**2))))/dx

@njit(cache=True)
def dweno_odepdqm2(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return 0.5*va**2*(-2/9*((1/2)*q0 + (1/2)*qm1)*(4*qm1 - 4*qm2)/(((q0 - qm1)**2 + 1/1000000)**2*((qm1 - qm2)**2 + 1/1000000)**3*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*qm1 - 1/2*qm2)*(4*qm1 - 4*qm2)/(((qm1 - qm2)**2 + 1/1000000)**3*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)) - 1/9*((3/2)*qm1 - 1/2*qm2)*(4*qm1 - 4*qm2)/(((qm1 - qm2)**2 + 1/1000000)**5*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)**2) - (1/6)/(((qm1 - qm2)**2 + 1/1000000)**2*((1/3)/((qm1 - qm2)**2 + 1/1000000)**2 + (2/3)/((q0 - qm1)**2 + 1/1000000)**2)))/(S*dx)

@njit(cache=True)
def dweno_odepdpp1(pm2, pm1, p0, pp1, pp2, qm2, qm1, q0, qp1, qp2, S, va, lam, D, dx):
    return (-0.5*va*((2/3)*((1/2)*p0 + (1/2)*pp1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 4/9*((1/2)*p0 + (1/2)*pp1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**5*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - 2/9*((3/2)*p0 - 1/2*pm1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((p0 - pm1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((p0 - pm1)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))) - 0.5*va*(-2/9*((1/2)*p0 + (1/2)*pm1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((p0 - pm1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*((3/2)*p0 - 1/2*pp1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)) - 1/9*((3/2)*p0 - 1/2*pp1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**5*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) - (1/6)/(((-p0 + pp1)**2 + 1/1000000)**2*((2/3)/((p0 - pm1)**2 + 1/1000000)**2 + (1/3)/((-p0 + pp1)**2 + 1/1000000)**2))) + 0.5*va*((2/3)*((1/2)*p0 + (1/2)*pp1)*(4*p0 - 4*pp1)/(((-p0 + pp1)**2 + 1/1000000)**3*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (2/3)*((1/2)*p0 + (1/2)*pp1)*(-2/3*(4*p0 - 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3 - 1/3*(-4*pp1 + 4*pp2)/((-pp1 + pp2)**2 + 1/1000000)**3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/3)*(-4*pp1 + 4*pp2)*((3/2)*pp1 - 1/2*pp2)/(((-pp1 + pp2)**2 + 1/1000000)**3*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)*((3/2)*pp1 - 1/2*pp2)*(-2/3*(4*p0 - 4*pp1)/((-p0 + pp1)**2 + 1/1000000)**3 - 1/3*(-4*pp1 + 4*pp2)/((-pp1 + pp2)**2 + 1/1000000)**3)/(((-pp1 + pp2)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)**2) + (1/2)/(((-pp1 + pp2)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2)) + (1/3)/(((-p0 + pp1)**2 + 1/1000000)**2*((1/3)/((-pp1 + pp2)**2 + 1/1000000)**2 + (2/3)/((-p0 + pp1)**2 + 1/1000000)**2))))/dx

